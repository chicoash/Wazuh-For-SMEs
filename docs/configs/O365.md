# This file contains Office365 Configurations

## Prerequisites
1. Microsoft Azure account with Admin rights.
2. Register an application in Azure to get:
    - Tenant ID
    - Client (Application) ID
    - Client Secret
3. Grant the app the required API permissions (Under Office 365 Management APIs)
    - ActivityFeed.Read
    - ActivityFeed.ReadDlp

## Register the Application in Microsoft Azure Portal
1. To register:
    - Go to Azure Portal → App registrations → New registration
    - Fill in name, account type → register
    - Copy Tenant ID & Client ID from Overview 
    - Under Certificates & secrets, add a new client secret → save value securely

2. Configure Permissions
    - Under your app → API permissions → Add a permission → Office 365 Management APIs
    - Grant ActivityFeed.Read and ActivityFeed.ReadDlp
    - Make sure to “Grant admin consent” <br>
[Full Guide Here](https://documentation.wazuh.com/current/cloud-security/office365/monitoring-office365-activity.html)

## Wazuh Configuration
#### Append the following configuration snippet inside the <ossec_config> </ossec_config> section of the /var/ossec/etc/ossec.conf file
``` xml
  <office365>
    <enabled>yes</enabled>
    <interval>1m</interval>
    <curl_max_size>1M</curl_max_size>
    <only_future_events>yes</only_future_events>
    <api_auth>
      <tenant_id><replace with your tenant id></tenant_id>
      <client_id><replace with your client/app id></client_id>
      <client_secret><replace with your client secret></client_secret>
      <api_type>commercial</api_type>
    </api_auth>
    <subscriptions>
      <subscription>Audit.SharePoint</subscription>
      <subscription>Audit.AzureActiveDirectory</subscription>
      <subscription>Audit.General</subscription>
    </subscriptions>
  </office365>
```